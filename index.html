import React, { useState, useEffect, useRef } from 'react';
import { Camera, Grid3x3, Layers, Zap, Rocket } from 'lucide-react';

const ProcessTimeline = () => {
  const [activePhase, setActivePhase] = useState(null);
  const [scrollY, setScrollY] = useState(0);
  const containerRef = useRef(null);

  const phases = [
    {
      id: 'discovery',
      title: 'Discovery',
      subtitle: 'Anchor Definition',
      days: '0–30',
      description: 'Definice anchor identity. Monogram, grid, baseline, ToV.',
      icon: Camera,
      color: 'from-blue-500 to-blue-600',
      items: [
        'Konstrukce monogramu',
        'Multi-grid architecture',
        'Anchor spacing system',
        'ToV baseline'
      ]
    },
    {
      id: 'strategy',
      title: 'Strategy',
      subtitle: 'System Layer Build',
      days: '31–60',
      description: 'Brand system, web architecture, OPS engine, dokumentace.',
      icon: Grid3x3,
      color: 'from-purple-500 to-purple-600',
      items: [
        'Brand component library',
        'Web system architecture',
        'OPS & governance',
        'Presentation engine'
      ]
    },
    {
      id: 'build',
      title: 'Build',
      subtitle: 'Fluid Identity Engine',
      days: '61–90',
      description: 'Mood-layers, adaptivní palety, pattern system, motion.',
      icon: Layers,
      color: 'from-emerald-500 to-emerald-600',
      items: [
        'Mood-layer engine',
        'Adaptive visual system',
        'Fluid governance',
        'Full QA engine'
      ]
    },
    {
      id: 'iterate',
      title: 'Iterate',
      subtitle: '30/60/90 Cycles',
      days: 'Ongoing',
      description: 'Weekly quiet review, monthly audit, quarterly rebaseline.',
      icon: Zap,
      color: 'from-orange-500 to-orange-600',
      items: [
        'Weekly quiet cycle',
        'Monthly system audit',
        'Seasonal mood updates',
        'Baseline adjustments'
      ]
    },
    {
      id: 'launch',
      title: 'Launch',
      subtitle: 'Full System Delivery',
      days: 'D90+',
      description: 'Complete Quiet Module engine. Anchor + System + Fluid.',
      icon: Rocket,
      color: 'from-red-500 to-red-600',
      items: [
        'Full brand engine',
        'Web ecosystem live',
        'Governance operational',
        'Continuous evolution'
      ]
    }
  ];

  useEffect(() => {
    const handleScroll = () => {
      if (containerRef.current) {
        const rect = containerRef.current.getBoundingClientRect();
        const scrollProgress = Math.max(0, Math.min(1, -rect.top / (rect.height - window.innerHeight)));
        setScrollY(scrollProgress);
      }
    };

    window.addEventListener('scroll', handleScroll);
    handleScroll();
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  return (
    <div className="min-h-screen bg-[#0a0a0a] text-white font-sans">
      {/* Header */}
      <div className="fixed top-0 left-0 right-0 z-50 bg-[#0a0a0a]/80 backdrop-blur-sm border-b border-white/10">
        <div className="max-w-7xl mx-auto px-8 py-6">
          <div className="flex items-center justify-between">
            <div>
              <h1 className="text-sm font-light tracking-[0.3em] uppercase text-white/80">
                Quiet Module
              </h1>
              <p className="text-[10px] tracking-[0.2em] uppercase text-white/40 mt-1">
                Process Framework
              </p>
            </div>
            <div className="text-right">
              <div className="text-2xl font-light text-white/90">90</div>
              <div className="text-[10px] tracking-[0.15em] uppercase text-white/40">Days</div>
            </div>
          </div>
        </div>
      </div>

      {/* Main Content */}
      <div ref={containerRef} className="pt-32 pb-20">
        <div className="max-w-7xl mx-auto px-8">
          {/* Intro */}
          <div className="mb-32 max-w-2xl">
            <h2 className="text-4xl font-light mb-6 leading-tight">
              Struktura před formou.<br />
              Systém před stylem.
            </h2>
            <p className="text-white/60 text-lg leading-relaxed">
              Quiet Module není projekt. Je to <span className="text-white/90">systémový engine</span> — 
              pevná kostra (Anchor) a adaptivní vrstvy (Fluid). Výsledek: identita, která se pohybuje, ne rozpadá.
            </p>
          </div>

          {/* Timeline */}
          <div className="relative">
            {/* Vertical Line */}
            <div className="absolute left-12 top-0 bottom-0 w-px bg-gradient-to-b from-white/20 via-white/10 to-transparent" />

            {/* Phases */}
            <div className="space-y-24">
              {phases.map((phase, idx) => {
                const Icon = phase.icon;
                const isActive = activePhase === phase.id;
                const baseDelay = idx * 0.1;

                return (
                  <div
                    key={phase.id}
                    className="relative pl-32 group"
                    onMouseEnter={() => setActivePhase(phase.id)}
                    onMouseLeave={() => setActivePhase(null)}
                  >
                    {/* Number Circle */}
                    <div className="absolute left-0 top-0 w-24 h-24 rounded-full border border-white/20 flex items-center justify-center bg-[#0a0a0a] group-hover:border-white/40 transition-all duration-500">
                      <Icon className="w-10 h-10 text-white/40 group-hover:text-white/80 transition-colors duration-500" />
                    </div>

                    {/* Content Card */}
                    <div
                      className={`
                        relative p-8 rounded-lg border border-white/10 bg-gradient-to-br from-white/5 to-transparent
                        group-hover:border-white/20 group-hover:from-white/8
                        transition-all duration-700 cursor-pointer
                        ${isActive ? 'scale-[1.02] shadow-2xl shadow-white/5' : ''}
                      `}
                      style={{
                        animation: `fadeInUp 0.8s ease-out ${baseDelay}s both`
                      }}
                    >
                      {/* Days Badge */}
                      <div className="absolute top-4 right-4">
                        <div className="px-3 py-1 rounded-full bg-emerald-500/10 border border-emerald-500/20">
                          <span className="text-xs tracking-widest uppercase text-emerald-400">
                            {phase.days}
                          </span>
                        </div>
                      </div>

                      {/* Title */}
                      <div className="mb-4">
                        <h3 className="text-3xl font-light mb-2 tracking-tight">
                          {phase.title}
                        </h3>
                        <p className="text-sm tracking-[0.2em] uppercase text-white/40">
                          {phase.subtitle}
                        </p>
                      </div>

                      {/* Description */}
                      <p className="text-white/70 leading-relaxed mb-6 max-w-2xl">
                        {phase.description}
                      </p>

                      {/* Items Grid */}
                      <div className="grid grid-cols-2 gap-3">
                        {phase.items.map((item, i) => (
                          <div
                            key={i}
                            className="flex items-start gap-2 text-sm text-white/60 group-hover:text-white/80 transition-colors duration-300"
                            style={{
                              animation: isActive ? `slideInLeft 0.4s ease-out ${i * 0.1}s both` : 'none'
                            }}
                          >
                            <div className="w-1 h-1 rounded-full bg-white/40 mt-2 flex-shrink-0" />
                            <span>{item}</span>
                          </div>
                        ))}
                      </div>

                      {/* Progress Indicator */}
                      {isActive && (
                        <div className="absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r overflow-hidden rounded-b-lg">
                          <div
                            className={`h-full bg-gradient-to-r ${phase.color}`}
                            style={{
                              animation: 'progressBar 1.5s ease-out'
                            }}
                          />
                        </div>
                      )}
                    </div>
                  </div>
                );
              })}
            </div>
          </div>

          {/* Footer CTA */}
          <div className="mt-32 pt-16 border-t border-white/10">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-white/60 text-sm mb-2">Kontinuita, ne revoluce.</p>
                <p className="text-white/40 text-xs tracking-wider uppercase">
                  Systém se vyvíjí s projektem, ne proti němu.
                </p>
              </div>
              <button className="px-8 py-4 rounded border border-white/20 hover:border-white/40 hover:bg-white/5 transition-all duration-300 text-sm tracking-wider uppercase">
                Start Project
              </button>
            </div>
          </div>
        </div>
      </div>

      {/* CSS Animations */}
      <style>{`
        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(30px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes slideInLeft {
          from {
            opacity: 0;
            transform: translateX(-10px);
          }
          to {
            opacity: 1;
            transform: translateX(0);
          }
        }

        @keyframes progressBar {
          from {
            width: 0%;
          }
          to {
            width: 100%;
          }
        }

        * {
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
        }
      `}</style>
    </div>
  );
};

export default ProcessTimeline;
