<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>Milla Nova - Clean 1:1 Experience</title>
    <style>
        body { margin: 0; overflow: hidden; background: #f3f3f3; font-family: "Cormorant Garamond", serif; }
        canvas { display: block; }
        .ui {
            position: fixed; top: 50px; left: 50%; transform: translateX(-50%);
            text-align: center; pointer-events: none; z-index: 10;
        }
        .ui h1 { font-weight: 300; letter-spacing: 12px; text-transform: uppercase; margin: 0; font-size: 18px; color: #333; }
    </style>
</head>
<body>

    <div class="ui">
        <h1>Milla Nova</h1>
    </div>

    <script type="importmap">
        { "imports": { 
            "three": "https://unpkg.com/three@0.160.0/build/three.module.js", 
            "gsap": "https://cdn.jsdelivr.net/npm/gsap@3.12.2/index.js" 
        } }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { gsap } from 'gsap';

        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0xf3f3f3);

        // KAMERA: Dál a užší úhel pro luxusní look
        const camera = new THREE.PerspectiveCamera(30, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 0, 60);

        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        document.body.appendChild(renderer.domElement);

        const world = new THREE.Group();
        scene.add(world);

        const radius = 25;
        const cardCount = 12;
        const cards = [];
        const loader = new THREE.TextureLoader();

        for (let i = 0; i < cardCount; i++) {
            const angle = (i / cardCount) * Math.PI * 2;
            const group = new THREE.Group();

            const geo = new THREE.PlaneGeometry(10, 14);
            const mat = new THREE.MeshBasicMaterial({
                map: loader.load(`https://picsum.photos/seed/${i + 10}/800/1200`),
                side: THREE.DoubleSide
            });

            const mesh = new THREE.Mesh(geo, mat);
            
            // Rozmístění do válce
            group.position.x = Math.sin(angle) * radius;
            group.position.z = Math.cos(angle) * radius;
            group.rotation.y = angle;

            group.add(mesh);
            world.add(group);
            cards.push({ mesh, group, originalZ: group.position.z });
        }

        let rot = 0;
        let targetRot = 0;
        const mouse = new THREE.Vector2();
        const raycaster = new THREE.Raycaster();

        window.addEventListener('wheel', e => targetRot -= e.deltaY * 0.0008);
        window.addEventListener('mousemove', e => {
            mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
        });

        function animate() {
            requestAnimationFrame(animate);

            rot = THREE.MathUtils.lerp(rot, targetRot, 0.05);
            world.rotation.y = rot;

            // Tilt celého světa (jemný náklon)
            world.rotation.x = THREE.MathUtils.lerp(world.rotation.x, mouse.y * 0.15, 0.05);
            world.position.y = THREE.MathUtils.lerp(world.position.y, mouse.y * 2, 0.05);

            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(cards.map(c => c.mesh));
            const hovered = intersects.length > 0 ? intersects[0].object : null;

            cards.forEach(card => {
                if (card.mesh === hovered) {
                    // HOVER STAV
                    card.mesh.renderOrder = 100;
                    card.mesh.material.depthTest = false;
                    gsap.to(card.mesh.position, { z: 7, duration: 0.5, ease: "power2.out" });
                    gsap.to(card.mesh.scale, { x: 1.4, y: 1.4, duration: 0.5, ease: "power2.out" });
                } else {
                    // KLIDOVÝ STAV
                    gsap.to(card.mesh.position, { 
                        z: 0, 
                        duration: 0.5, 
                        onComplete: () => {
                            if (card.mesh !== hovered) {
                                card.mesh.renderOrder = 0;
                                card.mesh.material.depthTest = true;
                            }
                        }
                    });
                    gsap.to(card.mesh.scale, { x: 1, y: 1, duration: 0.5 });
                }
            });

            renderer.render(scene, camera);
        }

        animate();

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
